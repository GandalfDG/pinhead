[gd_scene load_steps=14 format=3 uid="uid://cgdjulw3q7axd"]

[ext_resource type="Script" path="res://elements/pop_bumper/pop_bumper.gd" id="1_hvtx7"]
[ext_resource type="Script" path="res://elements/pop_bumper/Kicker.gd" id="2_8lq0t"]
[ext_resource type="PackedScene" uid="uid://b0t40leiarlgs" path="res://utilities/code_components/ScoringElement.tscn" id="2_an5yb"]
[ext_resource type="PackedScene" uid="uid://brj6pblp2w8hj" path="res://utilities/physics_components/SolenoidSpring.tscn" id="3_6ga7p"]
[ext_resource type="Material" uid="uid://b43rlaqm12whx" path="res://materials/ball.tres" id="3_y3ayh"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_42nhi"]
albedo_color = Color(1, 0.160784, 0.160784, 1)
emission_enabled = true
emission = Color(1, 0, 0, 1)
emission_energy_multiplier = 0.47

[sub_resource type="CylinderMesh" id="CylinderMesh_xa0o1"]
material = SubResource("StandardMaterial3D_42nhi")
top_radius = 0.97
bottom_radius = 1.295
height = 0.5

[sub_resource type="CylinderMesh" id="CylinderMesh_eqae3"]
top_radius = 0.75
bottom_radius = 0.75

[sub_resource type="CylinderShape3D" id="CylinderShape3D_xxs4f"]
radius = 0.75

[sub_resource type="CylinderShape3D" id="CylinderShape3D_hpw4f"]
height = 0.945644
radius = 1.17857

[sub_resource type="CylinderMesh" id="CylinderMesh_it0wu"]
material = ExtResource("3_y3ayh")
top_radius = 1.275
bottom_radius = 0.815
height = 0.4

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_x0pj0"]
points = PackedVector3Array(0, 0.2, -1.275, 0, 0.119969, -1.18314, -0.125054, 0.2, -1.26901, 0.124804, 0.2, -1.26901, 0.0888606, -0.120008, -0.902834, 0, -0.2, -0.815221, -0.0891103, -0.120008, -0.902834, -0.230888, 0.119969, -1.16043, -0.24886, 0.2, -1.25054, 0.24861, 0.2, -1.25054, 0.230638, 0.119969, -1.16043, 0.158751, -0.2, -0.799496, 0.0798746, -0.2, -0.811227, -0.0801244, -0.2, -0.811227, -0.159001, -0.2, -0.799496, -0.263337, -0.120008, -0.868138, -0.370169, 0.2, -1.22034, 0.36992, 0.2, -1.22034, 0.263087, -0.120008, -0.868138, 0.236379, -0.2, -0.780026, -0.236629, -0.2, -0.780026, -0.347205, -0.120008, -0.838185, -0.417595, 0.0399765, -1.00817, -0.487985, 0.2, -1.17815, 0.346956, -0.120008, -0.838185, 0.487735, 0.2, -1.17815, 0.417345, 0.0399765, -1.00817, 0.311761, -0.2, -0.753069, -0.312011, -0.2, -0.753069, -0.384397, -0.2, -0.718872, -0.557875, 0.119969, -1.04336, -0.601057, 0.2, -1.12449, 0.557625, 0.119969, -1.04336, 0.384147, -0.2, -0.718872, 0.600808, 0.2, -1.12449, -0.453039, -0.2, -0.677687, -0.606299, 0.0399765, -0.907327, -0.708389, 0.2, -1.06034, 0.606049, 0.0399765, -0.907327, 0.708139, 0.2, -1.06034, 0.45279, -0.2, -0.677687, -0.517189, -0.2, -0.630012, -0.634005, -0.0400157, -0.772289, -0.808981, 0.2, -0.985704, 0.633756, -0.0400157, -0.772289, 0.808731, 0.2, -0.985704, 0.516939, -0.2, -0.630012, -0.576346, -0.2, -0.576346, -0.706642, -0.0400157, -0.706642, -0.836688, 0.119969, -0.836688, -0.901586, 0.2, -0.901586, 0.706392, -0.0400157, -0.706642, 0.901336, 0.2, -0.901586, 0.836438, 0.119969, -0.836688, 0.576096, -0.2, -0.576346, -0.630012, -0.2, -0.517189, -0.772289, -0.0400157, -0.634005, -0.985704, 0.2, -0.808981, 0.985454, 0.2, -0.808981, 0.772039, -0.0400157, -0.634005, 0.629762, -0.2, -0.517189, -0.677687, -0.2, -0.453039, -0.907327, 0.0399765, -0.606299, -1.06034, 0.2, -0.708389, 1.06009, 0.2, -0.708389, 0.907077, 0.0399765, -0.606299, 0.677437, -0.2, -0.453039, -0.718872, -0.2, -0.384397, -1.04336, 0.119969, -0.557875, -1.12449, 0.2, -0.601057, 1.12424, 0.2, -0.601057, 1.04311, 0.119969, -0.557875, 0.718623, -0.2, -0.384397, -0.753069, -0.2, -0.312011, -0.838185, -0.120008, -0.347205, -1.00817, 0.0399765, -0.417595, -1.17815, 0.2, -0.487985, 1.1779, 0.2, -0.487985, 1.00792, 0.0399765, -0.417595, 0.837936, -0.120008, -0.347205, 0.752819, -0.2, -0.312011, -0.780026, -0.2, -0.236629, -0.868138, -0.120008, -0.263337, -1.22034, 0.2, -0.370169, 1.22009, 0.2, -0.370169, 0.867889, -0.120008, -0.263337, 0.779777, -0.2, -0.236629, -0.799496, -0.2, -0.159001, -1.16043, 0.119969, -0.230888, -1.25054, 0.2, -0.24886, 1.25029, 0.2, -0.24886, 1.16018, 0.119969, -0.230888, 0.799246, -0.2, -0.159001, -0.811227, -0.2, -0.0801244, -0.902834, -0.120008, -0.0891103, -1.26901, 0.2, -0.125054, 1.26876, 0.2, -0.125054, 0.902584, -0.120008, -0.0891103, 0.810978, -0.2, -0.0801244, -0.815221, -0.2, 0, -1.18314, 0.119969, 0, -1.275, 0.2, 0, 1.275, 0.2, 0, 0.814972, -0.2, 0, -0.811227, -0.2, 0.0798746, -0.902834, -0.120008, 0.0888606, -1.26901, 0.2, 0.124804, 1.26876, 0.2, 0.124804, 0.902584, -0.120008, 0.0888606, 0.810978, -0.2, 0.0798746, -0.799496, -0.2, 0.158751, -1.16043, 0.119969, 0.230638, -1.25054, 0.2, 0.24861, 1.25029, 0.2, 0.24861, 1.16018, 0.119969, 0.230638, 0.799246, -0.2, 0.158751, -0.780026, -0.2, 0.236379, -0.868138, -0.120008, 0.263087, -1.22034, 0.2, 0.36992, 1.22009, 0.2, 0.36992, 0.867889, -0.120008, 0.263087, 0.779777, -0.2, 0.236379, -0.753069, -0.2, 0.311761, -0.838185, -0.120008, 0.346956, -1.00817, 0.0399765, 0.417345, -1.17815, 0.2, 0.487735, 1.1779, 0.2, 0.487735, 1.00792, 0.0399765, 0.417345, 0.837936, -0.120008, 0.346956, 0.752819, -0.2, 0.311761, -0.718872, -0.2, 0.384147, -1.04336, 0.119969, 0.557625, -1.12449, 0.2, 0.600808, 1.12424, 0.2, 0.600808, 1.04311, 0.119969, 0.557625, 0.718623, -0.2, 0.384147, -0.907327, 0.0399765, 0.606049, -0.677687, -0.2, 0.45279, -1.06034, 0.2, 0.708139, 1.06009, 0.2, 0.708139, 0.907077, 0.0399765, 0.606049, 0.677437, -0.2, 0.45279, -0.772289, -0.0400157, 0.633756, -0.985704, 0.2, 0.808731, -0.630012, -0.2, 0.516939, 0.985454, 0.2, 0.808731, 0.772039, -0.0400157, 0.633756, 0.629762, -0.2, 0.516939, -0.706642, -0.0400157, 0.706392, -0.836688, 0.119969, 0.836438, -0.901586, 0.2, 0.901336, -0.576346, -0.2, 0.576096, 0.901336, 0.2, 0.901336, 0.836438, 0.119969, 0.836438, 0.706392, -0.0400157, 0.706392, 0.576096, -0.2, 0.576096, -0.808981, 0.2, 0.985454, -0.517189, -0.2, 0.629762, -0.634005, -0.0400157, 0.772039, 0.808731, 0.2, 0.985454, 0.633756, -0.0400157, 0.772039, 0.516939, -0.2, 0.629762, -0.708389, 0.2, 1.06009, -0.606299, 0.0399765, 0.907077, -0.453039, -0.2, 0.677437, 0.708139, 0.2, 1.06009, 0.606049, 0.0399765, 0.907077, 0.45279, -0.2, 0.677437, -0.557875, 0.119969, 1.04311, -0.601057, 0.2, 1.12424, -0.384397, -0.2, 0.718623, 0.600808, 0.2, 1.12424, 0.557625, 0.119969, 1.04311, 0.384147, -0.2, 0.718623, -0.347205, -0.120008, 0.837936, -0.417595, 0.0399765, 1.00792, -0.487985, 0.2, 1.1779, -0.312011, -0.2, 0.752819, 0.487735, 0.2, 1.1779, 0.417345, 0.0399765, 1.00792, 0.346956, -0.120008, 0.837936, 0.311761, -0.2, 0.752819, -0.236629, -0.2, 0.779777, -0.263337, -0.120008, 0.867889, -0.370169, 0.2, 1.22009, 0.36992, 0.2, 1.22009, 0.263087, -0.120008, 0.867889, 0.236379, -0.2, 0.779777, -0.159001, -0.2, 0.799246, -0.230888, 0.119969, 1.16018, -0.24886, 0.2, 1.25029, 0.24861, 0.2, 1.25029, 0.230638, 0.119969, 1.16018, 0.158751, -0.2, 0.799246, -0.0801244, -0.2, 0.810978, -0.0891103, -0.120008, 0.902584, -0.125054, 0.2, 1.26876, 0.124804, 0.2, 1.26876, 0.0888606, -0.120008, 0.902584, 0.0798746, -0.2, 0.810978, 0, -0.2, 0.814972, 0, 0.2, 1.275)

[sub_resource type="CylinderShape3D" id="CylinderShape3D_jlmpe"]
height = 1.98246
radius = 1.27366

[node name="PopBumper" type="Node3D"]
editor_description = "a pop bumper detects when the ball comes near and activates its kicker, sending the ball away at high speed."
script = ExtResource("1_hvtx7")

[node name="BumperCapMesh" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.11426, 0)
mesh = SubResource("CylinderMesh_xa0o1")

[node name="BumperBodyMesh" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
mesh = SubResource("CylinderMesh_eqae3")

[node name="BodyCollider" type="StaticBody3D" parent="BumperBodyMesh"]
collision_layer = 2
collision_mask = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="BumperBodyMesh/BodyCollider"]
shape = SubResource("CylinderShape3D_xxs4f")

[node name="PopTrigger" type="Area3D" parent="BumperBodyMesh"]
collision_layer = 0
collision_mask = 8

[node name="TriggerArea" type="CollisionShape3D" parent="BumperBodyMesh/PopTrigger"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.533936, 0)
shape = SubResource("CylinderShape3D_hpw4f")

[node name="Kicker" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.51036, 0)

[node name="SliderJoint3D" type="SliderJoint3D" parent="Kicker"]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1, 0, 0, 0)
node_a = NodePath("../Kicker")
linear_limit/lower_distance = 0.0
linear_limit/softness = 0.3

[node name="Kicker" type="RigidBody3D" parent="Kicker"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.119675, 0)
collision_layer = 4
collision_mask = 0
mass = 0.1
continuous_cd = true
linear_damp = 10.0
script = ExtResource("2_8lq0t")

[node name="KickerMesh" type="MeshInstance3D" parent="Kicker/Kicker"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.101264, 0)
mesh = SubResource("CylinderMesh_it0wu")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Kicker/Kicker"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.101264, 0)
shape = SubResource("ConvexPolygonShape3D_x0pj0")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="Kicker/Kicker"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.10245, 0)
shape = SubResource("CylinderShape3D_jlmpe")

[node name="LinearSolenoidSpring" parent="Kicker/Kicker" instance=ExtResource("3_6ga7p")]
transform = Transform3D(1, 0, 0, 0, -1, 8.74228e-08, 0, -8.74228e-08, -1, 0, 0, 0)
solenoid_force = 300.0
spring_stiffness = 10.0
resting_spring_extension = 6.0

[node name="ScoringElement" parent="." instance=ExtResource("2_an5yb")]

[connection signal="body_entered" from="BumperBodyMesh/PopTrigger" to="." method="_on_pop_trigger_body_entered"]
[connection signal="body_entered" from="BumperBodyMesh/PopTrigger" to="Kicker/Kicker" method="_on_pop_trigger_body_entered"]
